# نشر Doccano على Render

هذا المشروع هو نسخة مخصصة من Doccano مُعدة للنشر على منصة Render مع ميزة التحكم في الوصول عبر عناوين Gmail.

## الميزات المضافة

### 1. التحكم في الوصول عبر Gmail
- يمكن تحديد النطاقات المسموح بها عبر متغير البيئة `ALLOWED_GMAIL_DOMAINS`
- افتراضيًا، يُسمح فقط بعناوين `@gmail.com`
- يمكن إضافة نطاقات متعددة مفصولة بفواصل، مثل: `gmail.com,example.com`

### 2. تحسينات للنشر على Render
- Dockerfile محسن للعمل مع Render
- ملف `render.yaml` للنشر التلقائي
- إعدادات قاعدة بيانات PostgreSQL

## متغيرات البيئة المطلوبة

### متغيرات أساسية
- `ADMIN_USERNAME`: اسم المستخدم للمدير (افتراضي: admin)
- `ADMIN_PASSWORD`: كلمة مرور المدير
- `ADMIN_EMAIL`: بريد المدير الإلكتروني
- `SECRET_KEY`: مفتاح Django السري
- `DATABASE_URL`: رابط قاعدة البيانات PostgreSQL

### متغيرات التحكم في الوصول
- `ALLOWED_GMAIL_DOMAINS`: النطاقات المسموح بها (افتراضي: gmail.com)

### متغيرات الأداء
- `WORKERS`: عدد عمليات Gunicorn (افتراضي: 2)
- `CELERY_WORKERS`: عدد عمليات Celery (افتراضي: 1)
- `PORT`: منفذ الخدمة (افتراضي: 8000)

## خطوات النشر على Render

### 1. إعداد المستودع
```bash
git init
git add .
git commit -m "Initial commit"
git remote add origin YOUR_REPO_URL
git push -u origin main
```

### 2. إنشاء الخدمة على Render
1. اذهب إلى [Render Dashboard](https://dashboard.render.com)
2. انقر على "New" ثم "Blueprint"
3. اربط مستودع Git الخاص بك
4. سيتم إنشاء قاعدة البيانات والخدمة تلقائيًا

### 3. تكوين متغيرات البيئة
في لوحة تحكم Render، تأكد من تعيين:
- `ALLOWED_GMAIL_DOMAINS` إلى النطاقات المطلوبة
- `ADMIN_PASSWORD` إلى كلمة مرور قوية
- `ADMIN_EMAIL` إلى بريدك الإلكتروني

## استخدام النظام

### إنشاء حسابات المستخدمين
1. سجل الدخول كمدير باستخدام `/admin/`
2. اذهب إلى "Users" وأضف مستخدمين جدد
3. تأكد من أن عناوين البريد الإلكتروني تنتمي للنطاقات المسموح بها

### التحكم في الوصول
- فقط المستخدمون الذين لديهم عناوين بريد إلكتروني من النطاقات المحددة في `ALLOWED_GMAIL_DOMAINS` يمكنهم تسجيل الدخول
- إذا حاول مستخدم بعنوان غير مسموح تسجيل الدخول، سيحصل على رسالة خطأ

## الصيانة والتحديث

### تحديث النطاقات المسموح بها
1. اذهب إلى إعدادات الخدمة في Render
2. عدّل متغير `ALLOWED_GMAIL_DOMAINS`
3. أعد تشغيل الخدمة

### النسخ الاحتياطي
- قاعدة البيانات محفوظة تلقائيًا بواسطة Render
- يمكن تصدير البيانات من داخل Doccano

## استكشاف الأخطاء

### مشاكل تسجيل الدخول
- تأكد من أن عنوان البريد الإلكتروني ينتمي للنطاقات المسموح بها
- تحقق من سجلات الخدمة في Render

### مشاكل قاعدة البيانات
- تأكد من أن `DATABASE_URL` مُعرف بشكل صحيح
- تحقق من حالة قاعدة البيانات في Render

## الدعم
للحصول على المساعدة، راجع:
- [توثيق Doccano الرسمي](https://doccano.github.io/doccano/)
- [توثيق Render](https://render.com/docs)

